{% extends "base.html" %}

{% block content %}
{% load static %}
{% load i18n %}
{% if form %}



<br>
<br>

<form action="{% url 'filter' %}" method="post" class="border py-2 w-xl-50 w-lg-75 w-md-90 w-sm-90 w-xs-90 m-auto">
    {% csrf_token %}
    <div class="container-fluid">
        <div class="row">
            <div class="col-2 col-sm-2">
              
                    <label for="id_authors">{% trans 'Autors' %}</label>
                    </div>
                    <div class="col-10 col-sm-6">
                    <select name="authors" id="id_authors" data-autocomplete-light-language="en"
                        data-autocomplete-light-url="/author-autocomplete/" data-autocomplete-light-function="select2"
                        multiple></select>
                    </div>
                  <div class="col-12 col-sm-4">
                    <label for="id_authors_andor_0">{% trans 'filtertype' %}</label>
                    <label for="id_authors_andor_0"><input type="radio" name="authors_andor" class="form-check-label"
                            value="0" id="id_authors_andor_0" checked>{% trans 'or' %}</label>
                    <label for="id_authors_andor_1" class="pl-2"><input type="radio" name="authors_andor" class="form-check-label"
                            value="1" id="id_authors_andor_1">{% trans 'and' %}</label>
                        </div>
        </div>  
        <div class="row">
            <div class="col-2 col-sm-2">
                <label for="id_tags">{% trans 'Tags' %}</label>
                </div>
                <div class="col-10 col-sm-6">
                <select name="tags" id="id_tags" data-autocomplete-light-language="en"
                    data-autocomplete-light-url="/tag-autocomplete/" data-autocomplete-light-function="select2"
                    multiple></select>
                <div class="dal-forward-conf" id="dal-forward-conf-for_id_tags">
                    <script type="text/dal-forward-conf">[{"type": "field", "src": "authors"}]</script>
                </div>
                </div>

            <div class="col-12 col-sm-4">
                <label for="id_tags_andor_0">{% trans 'filtertype' %}</label>



                    <label for="id_tags_andor_0"><input type="radio" name="tags_andor" class="form-check-label"
                            value="0" id="id_tags_andor_0" checked>{% trans 'or' %}</label>
                    <label for="id_tags_andor_1" class="pl-2"><input type="radio" name="tags_andor" class="form-check-label"
                            value="1" id="id_tags_andor_1">{% trans 'and' %}</label>
                        </div>
        </div>
        <div class="row">
            <div class="col-2 col-sm-2">
                <label for="id_series">{% trans 'Series' %}</label>
                </div>
                <div class="col-10 col-sm-6">

                <select name="series" id="id_series" data-autocomplete-light-language="en"
                    data-autocomplete-light-url="/series-autocomplete/" data-autocomplete-light-function="select2"
                    multiple></select>
                <div class="dal-forward-conf" id="dal-forward-conf-for_id_series">
                    <script
                        type="text/dal-forward-conf">[{"type": "field", "src": "authors"}, {"type": "field", "src": "tags"}]</script>
                </div>
            </div>
          


            <div class="col-12 col-sm-4">
                <label for="id_series_andor_0">{% trans 'filtertype' %}</label>
            

                    <label for="id_series_andor_0"><input type="radio" name="series_andor" value="0"
                            id="id_series_andor_0" checked>{% trans 'or' %}</label>
                    <label for="id_series_andor_1" class="pl-2"><input type="radio" name="series_andor" value="1"
                            id="id_series_andor_1">{% trans 'and' %}</label>
                        </div>

        </div>
        <div class="row">
            <div class="col-2 col-sm-2">
                <label for="id_languages">{% trans 'Language' %}:</label>
                </div>
                <div class="col-10 col-sm-6">
                <select name="languages" id="id_languages" data-autocomplete-light-language="en"
                    data-autocomplete-light-url="/lang-autocomplete/" data-autocomplete-light-function="select2">
                    <option value="" selected>{% trans 'Language' %}</option>
                </select>
                </div>
 

            <div class="col-12 col-sm-4">
                <label for="id_ratings__rating__gte">{% trans 'MinRating' %}</label>

                <select name="ratings__rating__gte" id="id_ratings__rating__gte">
                    <option value="0" selected>0</option>
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5</option>
                    <option value="6">6</option>
                    <option value="7">7</option>
                    <option value="8">8</option>
                    <option value="9">9</option>
                    <option value="10">10</option>
                </select>
            </div>


        </div>
        <div class="row">
            <div class="col-12 col-sm-6"">
                <label for="id_pubdate__gte" class="w-75">{% trans 'Published between' %}</label>
           
    
                <input type="number" name="pubdate__gte" id="id_pubdate__gte">
 </div>

            <div class="col-12 col-sm-6">
                <label for="pubdate__lte">{% trans 'and' %} </label>

                <input type="number" name="pubdate__lte" id="id_pubdate__lte" class="w-xl-75">
            </div>
        </div>
        <div class="row">
            <div class="col-12 col-sm-6">
                <label for="id_timestamp__gte_month">{% trans 'Added to Calibre between' %} </label>
                <div class="w-220">
                <select name="timestamp__gte_month" id="id_timestamp__gte_month">
                    <option value="" selected>---</option>
                    <option value="1">January</option>
                    <option value="2">February</option>
                    <option value="3">March</option>
                    <option value="4">April</option>
                    <option value="5">May</option>
                    <option value="6">June</option>
                    <option value="7">July</option>
                    <option value="8">August</option>
                    <option value="9">September</option>
                    <option value="10">October</option>
                    <option value="11">November</option>
                    <option value="12">December</option>
                </select><select name="timestamp__gte_day" id="id_timestamp__gte_day">
                    <option value="" selected>---</option>
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5</option>
                    <option value="6">6</option>
                    <option value="7">7</option>
                    <option value="8">8</option>
                    <option value="9">9</option>
                    <option value="10">10</option>
                    <option value="11">11</option>
                    <option value="12">12</option>
                    <option value="13">13</option>
                    <option value="14">14</option>
                    <option value="15">15</option>
                    <option value="16">16</option>
                    <option value="17">17</option>
                    <option value="18">18</option>
                    <option value="19">19</option>
                    <option value="20">20</option>
                    <option value="21">21</option>
                    <option value="22">22</option>
                    <option value="23">23</option>
                    <option value="24">24</option>
                    <option value="25">25</option>
                    <option value="26">26</option>
                    <option value="27">27</option>
                    <option value="28">28</option>
                    <option value="29">29</option>
                    <option value="30">30</option>
                    <option value="31">31</option>
                </select><select name="timestamp__gte_year" id="id_timestamp__gte_year">
                    <option value="" selected>---</option>
                    <option value="2022">2022</option>
                    <option value="2021">2021</option>
                    <option value="2020">2020</option>
                    <option value="2019">2019</option>
                    <option value="2018">2018</option>
                    <option value="2017">2017</option>
                    <option value="2016">2016</option>
                    <option value="2015">2015</option>
                    <option value="2014">2014</option>
                    <option value="2013">2013</option>
                    <option value="2012">2012</option>
                    <option value="2011">2011</option>
                    <option value="2010">2010</option>
                    <option value="2009">2009</option>
                    <option value="2008">2008</option>
                    <option value="2007">2007</option>
                    <option value="2006">2006</option>
                    <option value="2005">2005</option>
                    <option value="2004">2004</option>
                    <option value="2003">2003</option>
                    <option value="2002">2002</option>
                    <option value="2001">2001</option>
                    <option value="2000">2000</option>
                    <option value="1999">1999</option>
                    <option value="1998">1998</option>
                    <option value="1997">1997</option>
                    <option value="1996">1996</option>
                    <option value="1995">1995</option>
                    <option value="1994">1994</option>
                    <option value="1993">1993</option>
                    <option value="1992">1992</option>
                    <option value="1991">1991</option>
                    <option value="1990">1990</option>
                    <option value="1989">1989</option>
                    <option value="1988">1988</option>
                    <option value="1987">1987</option>
                    <option value="1986">1986</option>
                    <option value="1985">1985</option>
                    <option value="1984">1984</option>
                    <option value="1983">1983</option>
                    <option value="1982">1982</option>
                    <option value="1981">1981</option>
                    <option value="1980">1980</option>
                    <option value="1979">1979</option>
                    <option value="1978">1978</option>
                    <option value="1977">1977</option>
                    <option value="1976">1976</option>
                    <option value="1975">1975</option>
                    <option value="1974">1974</option>
                    <option value="1973">1973</option>
                    <option value="1972">1972</option>
                    <option value="1971">1971</option>
                </select>
            </div>
            </div>

            <div class="col-12 col-sm-6">
                <label for="id_timestamp__lte_month"> {% trans 'and' %}</label>
                <div class="w-220">

                <select name="timestamp__lte_month" id="id_timestamp__lte_month">
                    <option value="" selected>---</option>
                    <option value="1">January</option>
                    <option value="2">February</option>
                    <option value="3">March</option>
                    <option value="4">April</option>
                    <option value="5">May</option>
                    <option value="6">June</option>
                    <option value="7">July</option>
                    <option value="8">August</option>
                    <option value="9">September</option>
                    <option value="10">October</option>
                    <option value="11">November</option>
                    <option value="12">December</option>
                </select><select name="timestamp__lte_day" id="id_timestamp__lte_day">
                    <option value="" selected>---</option>
                    <option value="1">1</option>
                    <option value="2">2</option>
                    <option value="3">3</option>
                    <option value="4">4</option>
                    <option value="5">5</option>
                    <option value="6">6</option>
                    <option value="7">7</option>
                    <option value="8">8</option>
                    <option value="9">9</option>
                    <option value="10">10</option>
                    <option value="11">11</option>
                    <option value="12">12</option>
                    <option value="13">13</option>
                    <option value="14">14</option>
                    <option value="15">15</option>
                    <option value="16">16</option>
                    <option value="17">17</option>
                    <option value="18">18</option>
                    <option value="19">19</option>
                    <option value="20">20</option>
                    <option value="21">21</option>
                    <option value="22">22</option>
                    <option value="23">23</option>
                    <option value="24">24</option>
                    <option value="25">25</option>
                    <option value="26">26</option>
                    <option value="27">27</option>
                    <option value="28">28</option>
                    <option value="29">29</option>
                    <option value="30">30</option>
                    <option value="31">31</option>
                </select><select name="timestamp__lte_year" id="id_timestamp__lte_year">
                    <option value="" selected>---</option>
                    <option value="2022">2022</option>
                    <option value="2021">2021</option>
                    <option value="2020">2020</option>
                    <option value="2019">2019</option>
                    <option value="2018">2018</option>
                    <option value="2017">2017</option>
                    <option value="2016">2016</option>
                    <option value="2015">2015</option>
                    <option value="2014">2014</option>
                    <option value="2013">2013</option>
                    <option value="2012">2012</option>
                    <option value="2011">2011</option>
                    <option value="2010">2010</option>
                    <option value="2009">2009</option>
                    <option value="2008">2008</option>
                    <option value="2007">2007</option>
                    <option value="2006">2006</option>
                    <option value="2005">2005</option>
                    <option value="2004">2004</option>
                    <option value="2003">2003</option>
                    <option value="2002">2002</option>
                    <option value="2001">2001</option>
                    <option value="2000">2000</option>
                    <option value="1999">1999</option>
                    <option value="1998">1998</option>
                    <option value="1997">1997</option>
                    <option value="1996">1996</option>
                    <option value="1995">1995</option>
                    <option value="1994">1994</option>
                    <option value="1993">1993</option>
                    <option value="1992">1992</option>
                    <option value="1991">1991</option>
                    <option value="1990">1990</option>
                    <option value="1989">1989</option>
                    <option value="1988">1988</option>
                    <option value="1987">1987</option>
                    <option value="1986">1986</option>
                    <option value="1985">1985</option>
                    <option value="1984">1984</option>
                    <option value="1983">1983</option>
                    <option value="1982">1982</option>
                    <option value="1981">1981</option>
                    <option value="1980">1980</option>
                    <option value="1979">1979</option>
                    <option value="1978">1978</option>
                    <option value="1977">1977</option>
                    <option value="1976">1976</option>
                    <option value="1975">1975</option>
                    <option value="1974">1974</option>
                    <option value="1973">1973</option>
                    <option value="1972">1972</option>
                    <option value="1971">1971</option>
                </select>
            </div>
            </div>


        </div>
        <div class="row form-group mx-2 py-1 mt-2 justify-content-center">
            <div class="col-xl-12 col-lg-12 col-md-4 col-sm-4 col-xs-4 d-inline-flex justify-content-around">
                <button class="btn btn-outline-success my-2 my-sm-0" type="submit">{% trans 'search' %}</button>
            </div>
        </div>


    </div>
    </div>




    
</form>

<script type="text/javascript" src="{% static 'admin/js/vendor/jquery/jquery.js' %}"></script>
{{ form.media }}

<script nonce="{{ request.csp_nonce }}">
    (function ($) {
        $('#add-form').click(function () {
            var index = $('#id_inline_test_models-TOTAL_FORMS').val()
            var newTable = $('#id_inline_test_models-__prefix__-DELETE').parents('table').clone()
            newTable.find(':input').each(function () {
                for (attr of ['name', 'id'])
                    $(this).attr(
                        attr,
                        $(this).attr(attr).replace('__prefix__', index)
                    )
            })
            newTable.insertBefore($(this))
            $('#id_inline_test_models-TOTAL_FORMS').val(
                parseInt($('#id_inline_test_models-TOTAL_FORMS').val()) + 1
            )
            newTable.slideDown()
        })
    })($)
</script>



{% endif %}
<h1 class="center">{% trans 'Books' %}</h1>

<script src="https://cdn.datatables.net/1.11.4/js/dataTables.bootstrap4.min.js"></script>
<script src="https://cdn.datatables.net/1.11.4/js/jquery.dataTables.min.js"></script>

<link rel="stylesheet" href="https://cdn.datatables.net/1.11.4/css/dataTables.bootstrap4.min.css">

<script nonce="{{ request.csp_nonce }}">
    $(document).ready(function () {
        $('#books').DataTable({ "searching": false, "pageLength": 50 });
        $('.dataTables_length').addClass('bs-select');
    });
</script>


<div class="container-fluid">
    <table id="books" class="table table-hover table-striped table-responsive-md table-bordered">
        <caption class="table-caption">{% trans 'Table with found books' %}</caption>
        <thead class="thead-dark">
            <tr>
                <!--When a header is clicked, run the sortTable function, with a parameter, 0 for sorting by names, 1 for sorting by country:-->
                <th scope="col" class="title">{% trans 'Title' %}</th>
                <th scope="col" class="author">{% trans 'Author' %}</th>
                <th scope="col" class="rating">{% trans 'Rating' %}</th>
                <th scope="col" class="tags-col">{% trans 'Tags' %}</th>
                <th scope="col" class="added">{% trans 'Added on' %}</th>
                <th scope="col" class="published">{% trans 'Published on' %}</th>
            </tr>
        </thead>
        <tbody>
            {% for book in book_list %}
            <tr>
                <th scope="row"><a href="{{ book.get_absolute_url }}">{{ book.title }}</a></th>
                <td class="authors" label="{% trans 'Authors' %}">
                    {% for author in book.authors.all %}
                    <a href="{{ author.get_absolute_url }}" rel="author">{{ author }}</a>
                    {% endfor %}
                </td>
                <td label="{% trans 'Rating' %}">
                    {% for rating in book.ratings.all %}
                    <a href="{{ rating.get_absolute_url }}" rel="rating">{{ rating }}</a>
                    {% endfor %}
                </td>
                <td class="tags" label="{% trans 'Tags' %}">
                    {% for tag in book.tags.all %}
                    <a href="{{ tag.get_absolute_url }}" rel="tag">{{ tag }}</a>
                    {% endfor %}
                </td>
                <td label="{% trans 'Added on' %}">{{ book.timestamp | date:"d/m/Y" }}</td>
                <td label="{% trans 'Published on' %}">{{ book.pubdate.year }}</td>
            </tr>
            {% endfor %}
        </tbody>


    </table>

</div>

<br>
<br>

{% endblock %}
